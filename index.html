<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Shark Bounty</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <link rel="icon" type="image/png" href="17510103.gif">
  <style>
    :root {
      --main-bg: linear-gradient(135deg, #0f2027 0%, #2c5364 100%);
      --accent: #00ffe7;
      --accent2: #ff61c9;
      --energy: linear-gradient(90deg, #ffcc70 0%, #ff61c9 100%);
      --card-bg: rgba(22, 31, 56, 0.95);
      --card-shadow: 0 6px 24px rgba(0,0,0,0.25);
      --btn-bg: linear-gradient(90deg, #00ffe7 0%, #ff61c9 100%);
      --btn-txt: #fff;
      --coin-circle: linear-gradient(135deg, #00ffe7 60%, #ff61c9 100%);
      --border: #222b3a;
      --danger: #ff556b;
      --success: #15e58a;
      --grey: #b0b7c3;
      --white: #fff;
      --usdt: #25ba7b;
      --ton: #179fff;
    }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', 'Roboto', Arial, sans-serif;
      background: var(--main-bg);
      color: var(--white);
      min-height: 100vh;
      max-width: 480px;
      margin-left: auto;
      margin-right: auto;
      overflow-x: hidden;
    }
    body {
      padding-bottom: 72px;
      background: var(--main-bg);
    }
    #loading-screen {
      position: fixed;
      z-index: 100000;
      left: 0; top: 0; right: 0; bottom: 0;
      width: 100vw;
      height: 100vh;
      background: #050e16;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      transition: opacity .5s;
    }
    #loading-screen video {
      width: 80vw;
      max-width: 260px;
      border-radius: 32px;
      box-shadow: 0 8px 32px #000c  ;
      background: #050e16;
    }
    #app {
      display: none;
      flex-direction: column;
      min-height: 100vh;
      width: 100vw;
      max-width: 480px;
    }
    .top-bar {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px 18px 6px 18px;
      font-size: 1.15rem;
      font-weight: 500;
      letter-spacing: 1px;
    }
    .balance-row {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 1.05rem;
      font-weight: 500;
      margin-bottom: 4px;
      margin-top: 2px;
    }
    .balance-coin {
      display: flex;
      align-items: center;
      gap: 4px;
      background: #143442;
      color: var(--accent);
      border-radius: 15px;
      padding: 4px 10px 4px 7px;
      font-size: 1.09rem;
      font-weight: bold;
      box-shadow: 0 3px 18px #00ffe72c;
      margin-right: 11px;
      min-width: 90px;
    }
    .balance-coin img {
      width: 20px; height: 20px;
    }
    .balance-coin .coin-txt {
      font-family: 'Segoe UI', 'Roboto', Arial, sans-serif;
      font-size: 1.04rem;
    }
    .balance-coin .coin-amt {
      margin-left: 7px;
      font-size: 1.08rem;
      font-weight: 600;
      letter-spacing: 1px;
      color: var(--white);
      text-shadow: 0 2px 8px #00ffe7b0;
    }
    .balance-usdt {
      display: flex;
      align-items: center;
      gap: 5px;
      background: #1d2832;
      color: var(--usdt);
      border-radius: 15px;
      padding: 4px 10px 4px 7px;
      font-size: 1.02rem;
      font-weight: bold;
      box-shadow: 0 3px 18px #25ba7b26;
      min-width: 90px;
    }
    .balance-usdt img {
      width: 18px; height: 18px;
    }
    .balance-usdt .usdt-txt {
      font-family: 'Segoe UI', 'Roboto', Arial, sans-serif;
      font-weight: 600;
    }
    .balance-usdt .usdt-amt {
      margin-left: 7px;
      font-size: 1.08rem;
      font-weight: 600;
      letter-spacing: 1px;
      color: var(--white);
      text-shadow: 0 2px 8px #25ba7b7a;
    }
    /* Home UI */
    #home-ui {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 16px;
      min-height: 400px;
      animation: fadein 0.8s;
    }
    @keyframes fadein { from { opacity: 0 } to { opacity: 1 } }
    /* Coin tapper */
    .coin-tapper-outer {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 18px;
      margin-bottom: 12px;
      position: relative;
      z-index: 2;
    }
    .coin-tapper {
      width: 162px;
      height: 162px;
      border-radius: 50%;
      background: var(--coin-circle);
      box-shadow: 0 7px 40px #00ffe7b0, 0 3px 24px #ff61c980;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border: 6px solid #1b2d3f;
      margin-bottom: 12px;
      position: relative;
      transition: box-shadow .15s;
      overflow: hidden;
      user-select: none;
      animation: coin-bounce 0.9s infinite alternate cubic-bezier(.53,1.84,.5,1.08);
    }
    @keyframes coin-bounce {
      from { transform: scale(1) }
      to { transform: scale(1.04) }
    }
    .coin-tapper img {
      width: 114px;
      height: 114px;
      border-radius: 50%;
      object-fit: cover;
      background: #050e16;
      box-shadow: 0 2px 18px #00ffe766;
      border: 4px solid #fff7;
      z-index: 2;
      transition: transform .1s;
    }
    .coin-tapper:active img {
      transform: scale(1.06);
    }
    .tap-plus-anim {
      position: absolute;
      left: 50%;
      top: 44%;
      transform: translate(-50%, -50%);
      font-size: 2rem;
      font-weight: bold;
      color: var(--accent2);
      text-shadow: 0 2px 10px #ff61c9bb, 0 1px 1px #111;
      pointer-events: none;
      opacity: 0;
      animation: tapplus .7s forwards;
    }
    @keyframes tapplus {
      0% { opacity: 1; transform: translate(-50%,-50%) scale(1.1);}
      70% { opacity: 1; transform: translate(-50%,-70%) scale(1.25);}
      100% { opacity: 0; transform: translate(-50%,-100%) scale(0.8);}
    }
    .energy-bar-outer {
      width: 85vw;
      max-width: 290px;
      height: 18px;
      background: #142030;
      border-radius: 18px;
      margin: 8px 0 0 0;
      box-shadow: 0 2px 8px #ff61c94d;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      position: relative;
      overflow: hidden;
    }
    .energy-bar-inner {
      height: 100%;
      background: var(--energy);
      border-radius: 18px;
      transition: width .3s cubic-bezier(.7,1.5,.7,.9);
      will-change: width;
      box-shadow: 0 2px 10px #fff5, 0 1px 4px #ffcc7066;
    }
    .energy-label {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%,-50%);
      font-size: 0.95rem;
      font-weight: bold;
      color: #2a2;
      text-shadow: 0 2px 12px #ffcc7073, 0 1px 1px #222;
      user-select: none;
    }
    /* Bottom nav */
    .bottom-nav {
      position: fixed;
      left: 0; right: 0; bottom: 0;
      width: 100vw;
      max-width: 480px;
      background: #19222f;
      display: flex;
      justify-content: space-around;
      align-items: center;
      height: 64px;
      box-shadow: 0 -6px 24px #000b;
      z-index: 1000;
      border-radius: 22px 22px 0 0;
      padding-bottom: env(safe-area-inset-bottom);
      border-top: 1.5px solid #1e293c;
    }
    .nav-btn {
      flex: 1;
      height: 64px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 2px;
      cursor: pointer;
      font-size: 0.94rem;
      color: var(--grey);
      font-weight: 400;
      transition: color .18s;
      user-select: none;
      border: none;
      background: none;
      outline: none;
    }
    .nav-btn.active {
      color: var(--accent);
      font-weight: bold;
    }
    .nav-btn img {
      height: 28px;
      width: 28px;
      margin-bottom: 4px;
      display: block;
      filter: drop-shadow(0 2px 8px #00ffe733);
    }
    /* Trade */
    #trade-ui {
      display: none;
      flex-direction: column;
      align-items: center;
      margin: 0 10px;
      animation: fadein 0.8s;
      min-height: 400px;
    }
    .plans-list {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 18px;
      margin-top: 16px;
      margin-bottom: 14px;
    }
    .plan-card {
      background: var(--card-bg);
      border-radius: 18px;
      box-shadow: var(--card-shadow);
      padding: 18px 16px 16px 16px;
      display: flex;
      flex-direction: column;
      gap: 7px;
      border: 2px solid #252f43;
      position: relative;
      overflow: hidden;
      min-width: 210px;
    }
    .plan-card .plan-title {
      font-size: 1.14rem;
      font-weight: 600;
      letter-spacing: 1px;
      color: var(--accent);
      margin-bottom: 2px;
    }
    .plan-row {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      font-size: 1rem;
      color: var(--white);
      align-items: center;
    }
    .plan-price {
      font-weight: 500;
      color: var(--usdt);
      font-size: 1.08rem;
      background: #183c31;
      border-radius: 7px;
      padding: 2.5px 9px;
    }
    .plan-validity {
      font-size: 0.97rem;
      color: #bbb;
      margin-right: 9px;
    }
    .plan-earning {
      font-size: 1.03rem;
      color: var(--success);
      margin-left: 10px;
      font-weight: 600;
      background: #122e29;
      border-radius: 7px;
      padding: 2.2px 9px;
    }
    .buy-btn, .claim-btn {
      margin-top: 7px;
      padding: 8px 0;
      border-radius: 12px;
      background: var(--btn-bg);
      color: var(--btn-txt);
      font-size: 1.08rem;
      font-weight: 600;
      letter-spacing: 1px;
      border: none;
      box-shadow: 0 2px 12px #00ffe733;
      cursor: pointer;
      width: 100%;
      transition: background .18s;
    }
    .buy-btn:active, .claim-btn:active {
      background: linear-gradient(90deg, #ff61c9 0%, #00ffe7 100%);
    }
    .claim-btn[disabled] {
      opacity: 0.6;
      pointer-events: none;
      background: #484b52;
      color: #ccc;
    }
    /* Tasks UI */
    #tasks-ui {
      display: none;
      flex-direction: column;
      align-items: center;
      min-height: 400px;
      justify-content: center;
      color: #888;
      font-size: 1.09rem;
      font-weight: 500;
    }
    /* Wallet UI */
    #wallet-ui {
      display: none;
      flex-direction: column;
      align-items: center;
      min-height: 400px;
      margin: 0 7px;
      animation: fadein 0.8s;
    }
    .wallet-tabs {
      display: flex;
      gap: 8px;
      width: 100%;
      margin: 18px 0 10px 0;
      justify-content: center;
    }
    .wallet-tab {
      background: #202c3b;
      color: var(--grey);
      border: none;
      border-radius: 12px;
      padding: 7px 18px;
      font-size: 1.01rem;
      font-weight: 500;
      cursor: pointer;
      transition: background .13s, color .13s;
    }
    .wallet-tab.active {
      background: var(--accent);
      color: #202c3b;
      font-weight: bold;
      box-shadow: 0 2px 12px #00ffe733;
    }
    /* Deposit/Withdraw */
    .wallet-section {
      margin: 0 auto;
      width: 100%;
      max-width: 350px;
      background: var(--card-bg);
      border-radius: 16px;
      padding: 17px 12px 12px 12px;
      box-shadow: var(--card-shadow);
      display: flex;
      flex-direction: column;
      gap: 13px;
      position: relative;
      margin-bottom: 16px;
      min-height: 145px;
    }
    .form-row {
      display: flex;
      flex-direction: column;
      gap: 5px;
      margin-bottom: 7px;
    }
    .form-row label {
      font-size: 0.98rem;
      color: #bbbbbb;
      font-weight: 500;
    }
    .form-row input, .form-row select {
      border-radius: 9px;
      border: 1.5px solid #28324d;
      font-size: 1.04rem;
      padding: 7px 10px;
      margin-top: 2px;
      background: #1a2133;
      color: var(--white);
      outline: none;
      transition: border .13s;
    }
    .form-row input:focus {
      border: 1.5px solid var(--accent);
    }
    .copy-btn {
      background: none;
      border: none;
      outline: none;
      cursor: pointer;
      margin-left: 7px;
      margin-top: -2px;
    }
    .copy-btn img {
      width: 25px;
      height: 25px;
      filter: drop-shadow(0 1.5px 8px #fff6);
    }
    .deposit-info-box {
      background: #172438;
      border-radius: 13px;
      padding: 10px 9px 13px 9px;
      margin-top: 6px;
      font-size: 1.02rem;
      color: #e1f3fc;
      box-shadow: 0 2px 10px #00ffe72b;
      position: relative;
    }
    .qr-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 7px;
      margin-top: 10px;
      margin-bottom: 10px;
    }
    .qr-section img {
      width: 160px;
      height: 160px;
      border: 5px solid #fff7;
      border-radius: 24px;
      box-shadow: 0 2px 24px #00ffe7a1, 0 3px 18px #222a;
      background: #fff;
    }
    .deposit-address, .deposit-memo {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-top: 3px;
      font-size: 0.98rem;
      font-family: monospace;
      word-break: break-all;
    }
    .memo-label {
      background: #2f3c56;
      color: #fff;
      font-size: 0.98rem;
      border-radius: 7px;
      padding: 2px 8px;
      margin-left: 7px;
    }
    .deposit-countdown {
      text-align: center;
      font-size: 1.08rem;
      color: var(--danger);
      font-weight: 700;
      margin-bottom: 6px;
      margin-top: 7px;
      letter-spacing: 1px;
    }
    .live-rate {
      color: var(--ton);
      font-size: 0.96rem;
      font-weight: bold;
      margin: 2px 0 5px 0;
      text-align: center;
    }
    /* History */
    .history-list {
      width: 100%;
      max-width: 340px;
      margin: 0 auto;
      background: var(--card-bg);
      border-radius: 15px;
      box-shadow: var(--card-shadow);
      padding: 10px 7px 8px 7px;
      min-height: 80px;
      margin-bottom: 15px;
      font-size: 0.97rem;
    }
    .history-item {
      display: flex;
      align-items: center;
      gap: 10px;
      border-bottom: 1.2px solid #23303b;
      padding: 7px 0;
      font-size: 1.01rem;
      color: #c7f9f5;
    }
    .history-item:last-child {
      border-bottom: none;
    }
    /* Profile UI */
    #profile-ui {
      display: none;
      flex-direction: column;
      align-items: center;
      min-height: 400px;
      animation: fadein 0.8s;
    }
    .profile-card {
      margin: 18px 0 10px 0;
      padding: 20px 18px;
      border-radius: 18px;
      background: var(--card-bg);
      box-shadow: var(--card-shadow);
      min-width: 210px;
      max-width: 340px;
    }
    .profile-avatar {
      width: 82px;
      height: 82px;
      border-radius: 50%;
      object-fit: cover;
      border: 4px solid var(--accent2);
      margin: 0 auto 10px auto;
      display: block;
      background: #fff;
      box-shadow: 0 2px 18px #ff61c985;
    }
    .profile-row {
      display: flex;
      align-items: center;
      gap: 9px;
      margin-top: 7px;
      font-size: 1.08rem;
    }
    .profile-label {
      font-size: 1rem;
      color: #17f3a9;
      min-width: 85px;
    }
    .profile-val {
      font-weight: 600;
      color: #fff;
      font-size: 1.09rem;
    }
    .profile-actions {
      margin: 16px 0 4px 0;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .profile-actions button {
      padding: 8px 0;
      border-radius: 12px;
      background: var(--btn-bg);
      color: var(--btn-txt);
      font-size: 1.04rem;
      font-weight: 600;
      letter-spacing: 1px;
      border: none;
      box-shadow: 0 2px 12px #00ffe733;
      cursor: pointer;
      width: 100%;
      transition: background .18s;
    }
    .profile-actions button:active {
      background: linear-gradient(90deg, #ff61c9 0%, #00ffe7 100%);
    }
    /* Misc */
    .hidden { display: none !important; }
    /* Scrollbar */
    ::-webkit-scrollbar { width: 0; }
  </style>
</head>
<body>
  <!-- LOADING SCREEN -->
  <div id="loading-screen">
    <video src="29f4182c-fb84-4f6e-830f-f560ae571afe.mp4" autoplay muted playsinline loop></video>
    <div style="margin-top: 14px; color: #fff; letter-spacing: 1px; font-size: 1.09rem; font-weight: 500;">Loading...</div>
  </div>
  <div id="app">
    <!-- Top Bar -->
    <div class="top-bar" id="top-bar">
      <span id="main-title">Shark Bounty</span>
    </div>
    <!-- BALANCE -->
    <div style="margin: 0 17px 10px 17px;">
      <div class="balance-row">
        <div class="balance-coin"><img src="17510103.gif"/><span class="coin-txt">SHB</span> <span id="shb-balance" class="coin-amt">0</span></div>
        <div class="balance-usdt"><img src="15207964.png"/><span class="usdt-txt">USDT</span> <span id="usdt-balance" class="usdt-amt">0.00</span></div>
      </div>
    </div>
    <!-- HOME UI -->
    <div id="home-ui">
      <div class="coin-tapper-outer">
        <div class="coin-tapper" id="coin-tapper">
          <img src="17510103.gif" alt="Shark Coin"/>
          <span class="tap-plus-anim" id="tap-plus-anim"></span>
        </div>
        <div class="energy-bar-outer">
          <div class="energy-bar-inner" id="energy-bar-inner"></div>
          <div class="energy-label" id="energy-label">Energy: 1200</div>
        </div>
      </div>
      <div style="margin-top:24px"></div>
    </div>
    <!-- TRADE UI -->
    <div id="trade-ui">
      <div class="plans-list" id="plans-list"></div>
    </div>
    <!-- TASKS UI -->
    <div id="tasks-ui">
      <div style="margin-top: 44px;">
        <img src="16104409.png" style="width:65px;opacity:0.7;">
        <div style="margin-top: 14px; font-size:1.1rem;">No tasks available right now.</div>
        <div style="color:#789; font-size:0.98rem;">(Admin panel will provide tasks soon.)</div>
      </div>
    </div>
    <!-- WALLET UI -->
    <div id="wallet-ui">
      <div class="wallet-tabs">
        <button class="wallet-tab active" id="deposit-tab">Deposit</button>
        <button class="wallet-tab" id="withdraw-tab">Withdraw</button>
        <button class="wallet-tab" id="history-tab">History</button>
      </div>
      <div id="wallet-sections">
        <div id="deposit-section" class="wallet-section"></div>
        <div id="withdraw-section" class="wallet-section" style="display:none"></div>
        <div id="history-section" class="history-list" style="display:none"></div>
      </div>
    </div>
    <!-- PROFILE UI -->
    <div id="profile-ui">
      <div class="profile-card">
        <img src="18827926.png" class="profile-avatar"/>
        <div class="profile-row"><span class="profile-label">Username:</span><span class="profile-val" id="profile-username">SharkUser</span></div>
        <div class="profile-row"><span class="profile-label">Referral:</span><span class="profile-val" id="profile-referral">None</span></div>
        <div class="profile-row"><span class="profile-label">Joined:</span><span class="profile-val" id="profile-joined">2025-09-16</span></div>
        <div class="profile-actions">
          <button onclick="alert('Support Coming Soon!')"><img src="2268705.png" style="width:20px;vertical-align:middle;margin-right:6px;">Support</button>
          <button onclick="alert('Leaderboards Coming Soon!')"><img src="13311710.png" style="width:20px;vertical-align:middle;margin-right:6px;">Leaderboard</button>
        </div>
      </div>
    </div>
    <!-- BOTTOM NAV -->
    <div class="bottom-nav" id="bottom-nav">
      <button class="nav-btn active" data-nav="home"><img src="1057118.png"/><span>Home</span></button>
      <button class="nav-btn" data-nav="trade"><img src="9084248.png"/><span>Trade</span></button>
      <button class="nav-btn" data-nav="tasks"><img src="16104409.png"/><span>Tasks</span></button>
      <button class="nav-btn" data-nav="wallet"><img src="6826311.png"/><span>Wallet</span></button>
      <button class="nav-btn" data-nav="profile"><img src="18827926.png"/><span>Profile</span></button>
    </div>
  </div>
  <script>
    // --- Constants ---
    const ENERGY_MAX = 1200, ENERGY_PER_TAP = 10, ENERGY_REFILL_PER_SEC = 30;
    const PLANS = [
      { id:'ton', name:'TON/USDT', price:10, validity:30, daily:1, img:'1142792.png' },
      { id:'not', name:'NOT/USDT', price:30, validity:30, daily:3, img:'1142792.png' },
      { id:'hmstr', name:'HMSTR/USDT', price:70, validity:30, daily:7, img:'1142792.png' },
      { id:'eth', name:'ETH/USDT', price:100, validity:30, daily:10, img:'1142792.png' },
      { id:'bnb', name:'BNB/USDT', price:150, validity:30, daily:15, img:'1142792.png' },
      { id:'btc', name:'BTC/USDT', price:200, validity:30, daily:20, img:'1142792.png' }
    ];
    const DEPOSIT_TON_ADDR = "UQCOL7arveEVrKfKa9v3SbZnKjIBnOavmX3aXdDV-XD1cQ09";
    const DEPOSIT_USDT_ADDR = "UQCOL7arveEVrKfKa9v3SbZnKjIBnOavmX3aXdDV-XD1cQ09";
    const TON_QR = "1890e18b5008f67e6d057aa7a47149bfc84740fc/Screenshot_2025-09-12-18-54-13-944_com.ton_keeper-edit.jpg";
    const USDT_QR = "a23720d6a315d2422e3943aa7bf779beac9acdad/Screenshot_2025-09-12-18-54-50-676_com.ton_keeper-edit.jpg";
    const TON_RATE = 3.20; // 1 TON = 3.20 USD

    // --- Storage ---
    function getState() {
      try {
        return JSON.parse(localStorage.getItem('sb-state')) || {};
      } catch {return {};}
    }
    function saveState(st) {
      localStorage.setItem('sb-state', JSON.stringify(st));
    }
    let state = getState();
    if (!state.shb) state.shb = 0;
    if (!state.usdt) state.usdt = 0;
    if (!state.energy) state.energy = ENERGY_MAX;
    if (!state.lastEnergyTs) state.lastEnergyTs = Date.now();
    if (!state.plans) state.plans = {};
    if (!state.history) state.history = [];
    saveState(state);

    // --- Loading screen ---
    setTimeout(()=>{
      document.getElementById('loading-screen').style.opacity=0;
      setTimeout(()=>{
        document.getElementById('loading-screen').style.display='none';
        document.getElementById('app').style.display='flex';
        navTo('home');
        updateBalances();
        updateEnergyBar();
        renderPlans();
        renderHistory();
      },430);
    },2000);

    // --- Navigation ---
    let navBtns = document.querySelectorAll('.nav-btn');
    navBtns.forEach(btn=>{
      btn.onclick = ()=> {
        navBtns.forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        navTo(btn.dataset.nav);
      }
    });
    function navTo(nav) {
      document.getElementById('main-title').textContent =
        nav==='home' ? "Shark Bounty" :
        nav==='trade' ? "Trade Plans" :
        nav==='tasks' ? "Daily Tasks" :
        nav==='wallet' ? "Wallet" :
        nav==='profile' ? "Profile" : "";
      document.getElementById('home-ui').style.display = nav==='home' ? 'flex' : 'none';
      document.getElementById('trade-ui').style.display = nav==='trade' ? 'flex' : 'none';
      document.getElementById('tasks-ui').style.display = nav==='tasks' ? 'flex' : 'none';
      document.getElementById('wallet-ui').style.display = nav==='wallet' ? 'flex' : 'none';
      document.getElementById('profile-ui').style.display = nav==='profile' ? 'flex' : 'none';
    }

    // --- Balances ---
    function updateBalances() {
      document.getElementById('shb-balance').innerHTML = state.shb;
      document.getElementById('usdt-balance').innerHTML = state.usdt.toFixed(2);
    }

    // --- Coin Tapper ---
    let energy = state.energy, lastEnergyTs = state.lastEnergyTs;
    let tapCooldown = false;
    function updateEnergyBar() {
      let now = Date.now();
      let diff = Math.floor((now - lastEnergyTs)/1000);
      if (energy<ENERGY_MAX && diff>0) {
        energy += diff*ENERGY_REFILL_PER_SEC;
        if (energy>ENERGY_MAX) energy=ENERGY_MAX;
        lastEnergyTs = now;
        state.energy=energy; state.lastEnergyTs=lastEnergyTs; saveState(state);
      }
      let perc = Math.floor(energy/ENERGY_MAX*100);
      document.getElementById('energy-bar-inner').style.width = perc+"%";
      document.getElementById('energy-label').textContent = "Energy: "+energy;
    }
    setInterval(()=>{
      updateEnergyBar();
    },1000);

    let tapAnimTimeout = null;
    document.getElementById('coin-tapper').onclick = ()=>{
      if (energy < ENERGY_PER_TAP) {
        let anim = document.getElementById('tap-plus-anim');
        anim.innerHTML = `<span style="color:#ff556b;">No Energy!</span>`;
        anim.style.opacity=1;
        clearTimeout(tapAnimTimeout);
        tapAnimTimeout = setTimeout(()=>{anim.style.opacity=0},700);
        return;
      }
      state.shb = (state.shb||0) + 1;
      energy -= ENERGY_PER_TAP;
      if (energy<0) energy=0;
      state.energy=energy; state.lastEnergyTs=Date.now();
      saveState(state);
      updateBalances();
      updateEnergyBar();
      // Animation
      let anim = document.getElementById('tap-plus-anim');
      anim.textContent = "+1";
      anim.style.opacity=1;
      anim.style.animation = 'none'; anim.offsetHeight; anim.style.animation = null;
      clearTimeout(tapAnimTimeout);
      tapAnimTimeout = setTimeout(()=>{anim.style.opacity=0},700);
    };

    // --- Plans (Trade) ---
    function renderPlans() {
      let plansEl = document.getElementById('plans-list');
      plansEl.innerHTML = '';
      PLANS.forEach(plan=>{
        let userPlan = state.plans[plan.id]||{};
        let active = !!userPlan.purchased;
        let canClaim = active && Date.now() - (userPlan.lastClaim||0) > 24*3600*1000;
        let expired = active && Date.now() > userPlan.purchased + plan.validity*24*3600*1000;
        let btnTxt = !active ? 'Buy' : (canClaim ? 'Claim' : 'Claimed');
        let disabled = active && !canClaim;
        let row = document.createElement('div');
        row.className = 'plan-card';
        row.innerHTML = `
          <div class="plan-title">${plan.name}</div>
          <div class="plan-row">
            <span class="plan-price"><img src="15207964.png" style="width:18px;vertical-align:middle;margin-right:2px;">$${plan.price}</span>
            <span class="plan-validity">Validity: ${plan.validity} days</span>
            <span class="plan-earning">Daily: $${plan.daily}</span>
          </div>
          <button class="${!active?'buy-btn':'claim-btn'}" ${disabled?'disabled':''} data-plan="${plan.id}">${btnTxt}</button>
        `;
        row.querySelector('button').onclick = ()=>{
          if (!active) buyPlan(plan);
          else if (canClaim) claimPlan(plan);
        };
        plansEl.appendChild(row);
      });
    }
    function buyPlan(plan) {
      if (state.usdt < plan.price) {
        alert("Insufficient USDT balance.");
        return;
      }
      if (state.plans[plan.id] && state.plans[plan.id].purchased) {
        alert("Plan already active.");
        return;
      }
      if (!confirm(`Buy ${plan.name} plan for $${plan.price}?`)) return;
      state.usdt -= plan.price;
      state.plans[plan.id]={purchased:Date.now(), lastClaim:0};
      state.history.push({type:'buy',plan:plan.name,amt:plan.price,date:new Date().toLocaleString()});
      saveState(state);
      updateBalances();
      renderPlans();
      renderHistory();
      alert("Plan purchased successfully!");
    }
    function claimPlan(plan) {
      let userPlan = state.plans[plan.id];
      if (!userPlan) return;
      let now = Date.now();
      if (now - (userPlan.lastClaim||0) < 24*3600*1000) {
        alert("Already claimed today.");
        return;
      }
      state.usdt += plan.daily;
      userPlan.lastClaim = now;
      state.plans[plan.id]=userPlan;
      state.history.push({type:'claim',plan:plan.name,amt:plan.daily,date:new Date().toLocaleString()});
      saveState(state);
      updateBalances();
      renderPlans();
      renderHistory();
      alert(`Claimed $${plan.daily} for ${plan.name}!`);
    }

    // --- WALLET TAB ---
    // Tabs
    document.getElementById('deposit-tab').onclick = ()=>showWalletTab('deposit');
    document.getElementById('withdraw-tab').onclick = ()=>showWalletTab('withdraw');
    document.getElementById('history-tab').onclick = ()=>showWalletTab('history');
    function showWalletTab(tab) {
      document.getElementById('deposit-tab').classList.toggle('active',tab==='deposit');
      document.getElementById('withdraw-tab').classList.toggle('active',tab==='withdraw');
      document.getElementById('history-tab').classList.toggle('active',tab==='history');
      document.getElementById('deposit-section').style.display = tab==='deposit'?'flex':'none';
      document.getElementById('withdraw-section').style.display = tab==='withdraw'?'flex':'none';
      document.getElementById('history-section').style.display = tab==='history'?'block':'none';
      if (tab==='history') renderHistory();
      if (tab==='deposit') renderDeposit();
      if (tab==='withdraw') renderWithdraw();
    }

    // Deposit Section
    function renderDeposit() {
      let el = document.getElementById('deposit-section');
      el.innerHTML = `
        <div class="form-row">
          <label>Deposit Method</label>
          <select id="deposit-method">
            <option value="ton">TONCOIN</option>
            <option value="usdt">USDT TON</option>
          </select>
        </div>
        <div class="form-row" id="deposit-amount-row">
          <label id="deposit-amt-label">TON Amount (min 3)</label>
          <input type="number" id="deposit-amount" min="3" placeholder="Enter TON amount"/>
        </div>
        <button class="buy-btn" id="deposit-confirm-btn" style="margin-top:3px;">Confirm</button>
      `;
      let methodSel = el.querySelector('#deposit-method');
      let amtInput = el.querySelector('#deposit-amount');
      let amtLabel = el.querySelector('#deposit-amt-label');
      let confirmBtn = el.querySelector('#deposit-confirm-btn');
      function updateLabel() {
        let m = methodSel.value;
        amtLabel.textContent = m==='ton' ? "TON Amount (min 3)" : "USDT Amount (min 10)";
        amtInput.placeholder = m==='ton' ? "Enter TON amount" : "Enter USDT amount";
        amtInput.min = m==='ton' ? 3 : 10;
      }
      methodSel.onchange = updateLabel;
      updateLabel();
      confirmBtn.onclick = ()=>{
        let m = methodSel.value;
        let amt = parseFloat(amtInput.value);
        if (isNaN(amt) || amt < (m==='ton'?3:10)) {
          alert(`Minimum ${m==='ton'?'3 TON':'10 USDT'} required.`);
          return;
        }
        showDepositQR(m, amt);
      };
    }
    // Deposit QR Page
    function showDepositQR(method, amt) {
      let el = document.getElementById('deposit-section');
      let addr = method==='ton'?DEPOSIT_TON_ADDR:DEPOSIT_USDT_ADDR;
      let qr = method==='ton'?TON_QR:USDT_QR;
      let memo = randomMemo();
      let usdtVal = method==='ton'?amt*TON_RATE:amt;
      let expire = Date.now()+15*60*1000;
      let timerId;
      function countdown() {
        let left = Math.max(0, Math.floor((expire-Date.now())/1000));
        let m = Math.floor(left/60), s = left%60;
        el.querySelector('.deposit-countdown').textContent = `Expires in: ${m}m ${s}s`;
        if (left <= 0) {
          clearInterval(timerId);
          el.innerHTML = `<div style="color:#ff556b; font-size:1.07rem;">Deposit session expired.<br><button class="buy-btn" onclick="showWalletTab('deposit')">Back</button></div>`;
        }
      }
      el.innerHTML = `
        <div class="deposit-countdown"></div>
        <div class="qr-section">
          <img src="${method==='ton'?TON_QR:USDT_QR}" alt="Deposit QR"/>
        </div>
        <div class="deposit-info-box">
          <div class="deposit-address">Address: <span>${addr}</span>
            <button class="copy-btn" onclick="copy('${addr}')" title="Copy Address"><img src="1622069.png"></button>
          </div>
          <div class="deposit-memo">Memo/Comment: <span class="memo-label">${memo}</span>
            <button class="copy-btn" onclick="copy('${memo}')" title="Copy Memo"><img src="1622069.png"></button>
          </div>
          <div class="live-rate">
            You will get: <b>${usdtVal.toFixed(2)} USDT</b>
            <span style="color:#bbb; font-size:0.94rem;display:block;margin-top:3px;">(1 TON = $${TON_RATE.toFixed(2)})</span>
          </div>
        </div>
        <div style="text-align:center;margin-top:9px;">
          <button class="buy-btn" onclick="confirmDeposit('${method}',${amt},'${memo}',${usdtVal})">I have paid</button>
        </div>
      `;
      countdown();
      timerId = setInterval(countdown,1000);
    }
    window.showDepositQR = showDepositQR; // allow onclick
    function confirmDeposit(method, amt, memo, usdtVal) {
      if (!confirm("Payment will be verified and USDT added on success. Add in 5-10s for test!")) return;
      state.usdt += usdtVal;
      state.history.push({type:'deposit',method,amt:usdtVal,date:new Date().toLocaleString()});
      saveState(state);
      updateBalances();
      renderHistory();
      alert("Deposit successful. USDT balance updated!");
      showWalletTab('history');
    }
    window.confirmDeposit = confirmDeposit;

    // Withdraw Section
    function renderWithdraw() {
      let el = document.getElementById('withdraw-section');
      el.innerHTML = `
        <div class="form-row">
          <label>Withdraw Method</label>
          <select id="withdraw-method">
            <option value="usdt">USDT TON</option>
            <option value="ton">TONCOIN</option>
          </select>
        </div>
        <div class="form-row">
          <label>Amount (min $3)</label>
          <input type="number" id="withdraw-amount" min="3" placeholder="Enter amount"/>
        </div>
        <div class="form-row">
          <label>Address (TON chain)</label>
          <input type="text" id="withdraw-address" placeholder="Enter TON chain address"/>
        </div>
        <div class="form-row">
          <label>Memo/Comment (optional)</label>
          <input type="text" id="withdraw-memo" placeholder="Memo/Comment (optional)"/>
        </div>
        <button class="buy-btn" id="withdraw-confirm-btn" style="margin-top:3px;">Confirm</button>
      `;
      el.querySelector('#withdraw-confirm-btn').onclick = ()=>{
        let method = el.querySelector('#withdraw-method').value;
        let amt = parseFloat(el.querySelector('#withdraw-amount').value);
        let addr = el.querySelector('#withdraw-address').value.trim();
        let memo = el.querySelector('#withdraw-memo').value.trim();
        if (isNaN(amt) || amt < 3) {
          alert("Minimum withdraw $3.");
          return;
        }
        if (!addr) {
          alert("Enter TON chain address.");
          return;
        }
        if (amt > state.usdt) {
          alert("Insufficient USDT balance.");
          return;
        }
        if (!confirm("Confirm withdraw?")) return;
        state.usdt -= amt;
        state.history.push({type:'withdraw',method,amt,date:new Date().toLocaleString(),addr,memo});
        saveState(state);
        updateBalances();
        renderHistory();
        alert("Withdraw request submitted!");
        showWalletTab('history');
      };
    }

    // History
    function renderHistory() {
      let el = document.getElementById('history-section');
      if (!state.history || !state.history.length) {
        el.innerHTML = `<div style="color:#bbb;text-align:center;">No history found.</div>`;
        return;
      }
      el.innerHTML = '';
      state.history.slice().reverse().forEach(h=>{
        let txt = '';
        if (h.type==='deposit') txt = `Deposit (${h.method}) +$${h.amt}`;
        else if (h.type==='withdraw') txt = `Withdraw (${h.method}) -$${h.amt}<br><span style="color:#aaa;font-size:0.93em;">To: ${h.addr||''} Memo: ${h.memo||''}</span>`;
        else if (h.type==='buy') txt = `Bought Plan ${h.plan} -$${h.amt}`;
        else if (h.type==='claim') txt = `Claimed ${h.plan} +$${h.amt}`;
        el.innerHTML += `<div class="history-item">${txt}<span style="margin-left:auto;color:#999;">${h.date}</span></div>`;
      });
    }

    // Copy util
    function copy(txt) {
      navigator.clipboard.writeText(txt);
      alert("Copied!");
    }
    window.copy = copy;

    // Memo generator
    function randomMemo() {
      let s = '';
      let chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ123456789';
      for (let i=0;i<7;i++) s+=chars[Math.floor(Math.random()*chars.length)];
      return s;
    }

    // --- Profile Dummy data ---
    document.getElementById('profile-username').textContent = "SharkUser";
    document.getElementById('profile-referral').textContent = "None";
    document.getElementById('profile-joined').textContent = (new Date()).toISOString().slice(0,10);

    // --- First tab triggers ---
    showWalletTab('deposit');

  </script>
</body>
</html>
